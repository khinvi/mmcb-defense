# Multi-Modal Attack Taxonomy: Structured Data and Code Injections

This document outlines the comprehensive taxonomy of multi-modal prompt injection attacks focused specifically on structured data files and code inputs used in this research project.

## Project Context (MMCB)

- **All advanced, production-quality attack examples are located in:**
  - `data/generated/structured/` (JSON, CSV, YAML, XML)
  - `data/generated/code/` (Python, JavaScript)
  - `data/generated/advanced/` (cross-format, polymorphic, steganographic, encoding-based)
- **To regenerate all examples, run:**
  - `python src/attacks/generate_mmcb_examples.py`
- **Legacy/simple attacks have been replaced by deeply technical, realistic, and diverse examples.**

## Attack Classifications

### By File Type

Attacks are classified based on the file format used:

1. **Text + Structured Data**: JSON, CSV, YAML, XML (see `data/generated/structured/`)
2. **Text + Code**: Python, JavaScript (see `data/generated/code/`)
3. **Cross-Format/Polymorphic**: Embedded JSON in Python, YAML with Python, XML with encoding, etc. (see `data/generated/advanced/`)

### By Attack Technique

- **Hidden Metadata Fields**: Deeply nested, non-standard fields (e.g., `_meta`, `_hidden`)
- **Obfuscated Instructions**: Unicode homoglyphs, base64, hex encoding
- **Multi-Stage Injections**: Instructions split across headers, rows, and fields
- **Format-Specific Exploits**: CDATA in XML, YAML anchors, CSV formula injection
- **Steganography**: Whitespace, comment abuse
- **Polymorphic/Encoding**: Cross-format, encoded payloads

### By Injection Location

- **Metadata Fields**
- **Comments**
- **Nested Structures**
- **Attributes/Headers**
- **Encoding/Obfuscation**

### By Target Objective

- **System Instruction Override**
- **Information Extraction**
- **Behavior Modification**
- **Content Filter Bypass**

## Example Attack Vectors (see data/generated/ for full files)

### JSON (finance_injection.json)
- Deeply nested `_meta` with base64-encoded instruction
- Unicode homoglyphs in property names

### CSV (userdb_attack.csv)
- Formula injection in header/row
- Unicode-encoded payloads

### YAML (api_config_attack.yaml)
- Anchor/alias abuse
- Hidden base64 in metadata
- Unicode homoglyphs in keys

### XML (messaging_attack.xml, hex_encoded_xml_attack.xml)
- CDATA with embedded instructions
- Attribute injection with homoglyphs
- Hex-encoded payloads in attributes

### Python/JavaScript (user_manager_attack.py, notification_attack.js)
- Multi-stage comment and docstring injections
- String literal and template variable attacks
- Variable name obfuscation
- Import/annotation exploits

### Advanced/Polymorphic (crossformat_json_in_python.py, polymorphic_yaml_python_attack.yaml)
- Embedded JSON in Python
- YAML with Python code and steganographic whitespace
- Encoding/decoding attack patterns

## Automation

- All examples are generated by `src/attacks/generate_mmcb_examples.py` for reproducibility and extensibility.
- To start with a clean slate, delete contents of `data/checkpoints/`, `data/results/`, and `data/reports/` before running new experiments.

## For full code and data examples, see the MMCB repository structure and the above folders.